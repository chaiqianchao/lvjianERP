<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>院产值详情</title>
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/css/details.css">
	<link rel="stylesheet" type="text/css" href="__STATIC__/css/font.css" />
	<link rel="stylesheet" type="text/css" href="__STATIC__/css/xadmin.css" />
	<script type="text/javascript" src="__STATIC__/lib/layui/layui.js"></script>
	<script type="text/javascript" src="__STATIC__/js/xadmin.js"></script>
	<script type="text/javascript" src="__STATIC__/js/FileSave.js"></script>
</head>
<body>
<div class="card">
	<div class="layui-col-md12">
        <div class="layui-card" >
        	<div class="back-pro" style="background-color: #fff;padding-bottom: 10px;"><a href="javascript:history.go(-1)">返回</a></div>
            <div class="layui-card-body ">
            	<!-- 1 -->
		    	<div class="layui-collapse" lay-filter="test">
		            <div class="layui-colla-item">
		            <h2 class="layui-colla-title">基本信息<i class="layui-icon layui-colla-icon"></i></h2>
		            <div class="layui-colla-content">
		                <table class="layui-table" id="table">
		                    <tbody>
		                        <tr>
		                            <th>工程号</th>
		                            <td>{$content["project_id"]}</td>
		                            <th class="td-manage"></th>
		                        </tr>
		                        <tr>
		                            <th>工程名称</th>
		                            <td>{$content["project_name"]}</td>
		                        	<th class="td-manage">
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>发包人</th>
		                            <td>{$content["project_contractor"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'project_contractor', '发包人', '{$content["project_contractor"]}', 'departmentvalueDateEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>代建方</th>
		                            <td>{$content["project_agent"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'project_agent', '代建方', '{$content["project_agent"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>加晒费总额</th>
		                            <td>{$content["sum_fee"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}','sum_fee', '加晒费总额', '{$content["sum_fee"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>已结算加晒费</th>
		                            <td>{$content["sum_settled"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'sum_settled', '已结算加晒费', '{$content["sum_settled"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>免费金额</th>
		                            <td>{$content["sum_free"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'sum_free', '免费金额', '{$content["sum_free"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                    <!--     <tr>
		                            <th>应收金额</th>
		                            <td>{content["sum_receivable"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{content["id"]}', 'sum_receivable', '应收金额', '{content["sum_receivable"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr> -->
		                        <tr>
		                            <th>图纸份数</th>
		                            <td>{$content["sum_number"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'sum_number', '新增份数', '{$content["sum_number"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>加晒时间</th>
		                            <td>{$content["sum_date"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'sum_date', '	加晒时间', '{$content["sum_date"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                        <tr>
		                            <th>备注</th>
		                            <td>{$content["sum_remarks"]}</td>
		                        	<th class="td-manage">
		                        		{if condition="$limit eq 2"}
		                                <a title="编辑" onclick="member_edit('{$content["id"]}', 'sum_remarks', '备注', '{$content["sum_remarks"]}', 'tosumEdit')" href="javascript:;">
		                                  <i class="layui-icon">&#xe642;</i>
		                                </a>
		                                {/if}
		                            </th>
		                        </tr>
		                    </tbody>
		                </table>
		            </div>
		            </div>
		        </div>
		        <!-- 小计2-->
				<div style="background-color: #fff;padding: 10px;text-align: right;">
          			<button class="layui-btn" onclick="leadingOut()" style="background-color: #319587;margin-right: 10px;">导出数据</button>

				</div>
			</div>
		</div>
	</div>
</div>

<script type="text/javascript">
function member_edit(id, column, chinese, content, type) {
	content =content.replace(/%/g, '%25');
	var url = '{:url("index/detailEdit")}' +"?id="+id+"&column="+column+"&chinese="+chinese+"&content="+content+"&type="+type;
	xadmin.open('详情修改', url);
}
var template =
    ' <style type="text/css">' +
    'table {' +
    '    font-family: verdana,arial,sans-serif;' +
    '    font-size:11px;' +
    '    color:#333333;' +
    '    border-width: 1px;' +
    '    border-color: #666666;' +
    '    border-collapse: collapse;' +
    '}' +
    'table th {' +
    '    padding: 8px;' +
    '    width: 200px;' +
    '  height: 30px;' +
    '    border-style: solid;' +
    '    border-color: #9a9a9a;' +
    '    color: #000000;' +
    '    background-color: #ffffff;' +
    '}' +
    'table td {' +
    '    width: 200px;' +
    '  height: 30px;' +
    '    padding: 8px;' +
    '    text-align: center;' +
    '    border-style: solid;' +
    '    border-color: #9a9a9a;' +
    '}' +
    ' ' +
    '</style>';
function tableToExcel(tableid, sheetName, template, fileName) {
    if (!tableid.nodeType) tableid = document.getElementById(tableid);
    var html = "<html xmlns:x=\"urn:schemas-microsoft-com:office:excel\">\n" +
        "    <head>\n" +
        "        <!--[if gte mso 9]><xml>\n" +
        "            <x:ExcelWorkbook>\n" +
        "                <x:ExcelWorksheets>\n" +
        "                    <x:ExcelWorksheet>\n" +
        "                        <x:Name>"+ sheetName +"</x:Name>\n" +
        "                        <x:WorksheetOptions>\n" +
        "                            <x:Print>\n" +
        "                                <x:ValidPrinterInfo />\n" +
        "                            </x:Print>\n" +
        "                        </x:WorksheetOptions>\n" +
        "                    </x:ExcelWorksheet>\n" +
        "                </x:ExcelWorksheets>\n" +
        "            </x:ExcelWorkbook>\n" +
        "        </xml>\n" +
        "        <![endif]-->\n" + template +
        "    </head>" +
        "<body>" + tableid.outerHTML +
        "</body></html>";
    var blob = new Blob([html], {type: "text/plain;charset=utf-8"});
    saveAs(blob, fileName);
}

function leadingOut() {
  //询问框
  layer.confirm('只能导出当前页的数据哦', {
    btn: ['取消导出','依旧导出'] //按钮
  }, function(){
    layer.msg('已取消', {icon: 1});
  }, function(){
    tableToExcel('table','sheet1',template,'Data.xlsx');
  });
}
</script>
</body>
</html>